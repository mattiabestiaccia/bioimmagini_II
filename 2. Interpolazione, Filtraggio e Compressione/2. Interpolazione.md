---
tags:
  - interpolazione
  - risoluzione-spaziale
  - reslicing
  - nearest-neighbor
  - interpolazione-bilineare
  - interpolazione-bicubica
  - voxel-isotropi
  - FOV
aliases:
  - Interpolazione
  - Reslicing
---

> [!nav]- Navigazione
> **Precedente:** [[1. Intro|â† Introduzione Preprocessing]] | [[../INDICE|ğŸ“‘ Indice]] | **Successivo:** [[3. Filtraggio|Filtraggio â†’]]

## Interpolazione delle Immagini Biomediche

### Dimensioni delle Immagini Biomediche

Le dimensioni dell'immagine sono definite a livello di acquisizione o dal processo di ricostruzione implementato nello scanner.

**Relazione con risoluzione spaziale:**
A paritÃ  di FOV (Field of View), migliore risoluzione spaziale â†’ pixel piÃ¹ piccoli â†’ immagine di dimensioni maggiori

**Dimensioni tipiche per modalitÃ :**
- **SPECT:** 64Ã—64
- **MRI cardiaca:** 256Ã—256
- **CT e MRI:** 512Ã—512
- **CT ad alta risoluzione:** 1024Ã—1024
- **Radiografia classica:** risoluzioni piÃ¹ alte
- **Mammografia:** fino a 5000Ã—5000

### Quando Ã¨ Necessaria l'Interpolazione

Nell'elaborazione delle immagini biomediche puÃ² essere necessario **cambiare la dimensione** delle immagini, aumentando o diminuendo il numero di pixel.

**Esempi di applicazioni:**

#### 1. Visualizzazione su Schermo

**Problema:** dimensione immagine radiologica â‰  dimensione supporto digitale (stampa/schermo)

**Monitor tipico per refertazione radiologica:** 1600Ã—1200 pixel

**Soluzione:** interpolare l'immagine per adattare le dimensioni a quelle dello schermo (o porzione di schermo)

#### 2. Voxel Isotropi in 3D

Cambio di risoluzione spaziale nelle immagini 3D per ottenere **voxel cubici** â†’ immagini isotrope

### Concetto di Campionamento Spaziale

L'immagine biomedica Ã¨ una serie di **campioni di un processo fisico** acquisiti in uno spazio discreto, con risoluzione uguale alla dimensione del pixel.

**In pratica:** l'immagine fornisce campioni in $N \times M$ locazioni spaziali poste al **centro dei pixel** (convenzione DICOM)

**Esempio:**
- Immagine: FOV 340Ã—340 mm, dimensioni 256Ã—256
- Pixel size: $340/256 = 1.32$ mm (intervallo di campionamento spaziale)
- Ogni pixel corrisponde a un punto della griglia

**Aumento risoluzione:**
Se vogliamo raddoppiare la risoluzione (es. 512Ã—512), dobbiamo:
1. Aumentare la risoluzione della griglia
2. Definire nuovi pixel nelle posizioni corrispondenti ai nuovi punti

## Metodi di Interpolazione

Il valore dei nuovi pixel viene dedotto da quello dei pixel vicini. Per ottimizzare il tempo di elaborazione si utilizzano solo i pixel piÃ¹ "vicini" al pixel da ricomputare.

### 1. Nearest Neighbor (NN)

**Principio:** assegna al nuovo pixel il valore del pixel piÃ¹ vicino

**Vantaggi:**
- Molto veloce
- Non introduce nuovi livelli di grigio (rilevante dal punto di vista diagnostico)

**Svantaggi:**
- Crea gruppi di pixel con lo stesso valore
- Impressione visiva di immagine "pixellata"

### 2. Interpolazione Bilineare

**Principio:** il nuovo valore del pixel Ã¨ stimato come **media pesata** dei valori dei pixel piÃ¹ vicini
- **2D:** 4 pixel piÃ¹ vicini
- **3D:** 8 pixel piÃ¹ vicini

**Formula:**
Il valore del pixel nel punto $P$ Ã¨ la somma dei valori dei pixel in $Q_{ij}$ pesati per l'area normalizzata del rettangolo opposto a $Q_{ij}$

**Vantaggi:**
- QualitÃ  visiva migliore rispetto a NN

**Interpretazione:**
- Stima del valore atteso del segnale in $P$
- Modella la transizione del segnale tra pixel come una **retta**
- Utilizza solo i due campioni piÃ¹ vicini per stimare i parametri della retta

### 3. Interpolazione Bicubica

**Estensione del concetto:**
- Utilizza modelli **non lineari** (polinomi di terzo grado)
- Griglia di **16 pixel**
- Funzioni polinomiali di grado crescente o funzioni sinusoidali

### 4. Interpolazione Spline

**Metodo piÃ¹ perfezionato:**
- L'intera distribuzione dei pixel sull'immagine viene modellata come una **superficie**
- Valori interpolanti ottenuti di conseguenza

### Considerazioni Pratiche

**Nella visualizzazione di immagini mediche sono importanti:**
1. **QualitÃ  visiva** percepita dell'interpolazione
2. **Tempo di elaborazione** (il sistema deve rispondere in tempo reale, es. durante zoom)

## Interpolazione 3D e Reslicing

### Problema delle Immagini 3D

Tipicamente nelle immagini 3D:
$$dz > dx = dy$$

Dove:
- $dz$: distanza inter-fetta (asse z)
- $dx, dy$: risoluzione pixel sulla singola fetta (piano x-y)

### Reslicing: Creazione Volume Isotropo

**Obiettivo:** ottenere volume isotropo con risoluzione spaziale uguale su tutti gli assi

**Operazione:** interpolazione 3D che crea nuove slice con distanza inter-fetta uguale alla risoluzione del pixel

**Vincolo:** mantenere costante il FOV (regione di spazio coperta dal volume)

### Calcolo del Reslicing

**Dati iniziali:**
Volume con $N_z$ fette e FOV = $[\text{dimX}, \text{dimY}, \text{dimZ}]$

Dove:
$$\text{dimX} = dx \cdot N_x \quad \text{(pixel spacing Ã— colonne)}$$
$$\text{dimY} = dy \cdot N_y \quad \text{(pixel spacing Ã— righe)}$$
$$\text{dimZ} = dz \cdot N_z \quad \text{(slice spacing Ã— numero slice)}$$

**Se $dz > dx = dy$** (caso tipico), dobbiamo creare nuove slice con:
$$dz_1 = dx$$

**Conservazione FOV:**
$$\text{dimZ} = dz \cdot N_z = dz_1 \cdot N_{z1} = dx \cdot N_{z1}$$

**Numero nuove slice:**
$$N_{z1} = \frac{dz \cdot N_z}{dx}$$

### Ricostruzione Piani Diversi

**Applicazione:** ottenere piani di vista diversi da quelli acquisiti

**Esempi:**
- Piano **sagittale** da acquisizione assiale
- Piano **coronale** da acquisizione assiale
- Piano **obliquo** da acquisizione assiale

**Utilizzo:** comune in TAC

## Attenzioni con Software Generici

**Problema:** gli algoritmi standard di interpolazione nei software generici (es. MATLAB) presuppongono:
- Pixel quadrati
- Voxel cubici

**RealtÃ  immagini biomediche:** questa assunzione puÃ² essere **errata**, specialmente in 3D

**Soluzione:** il processo di interpolazione deve tener conto della **posizione reale** dei pixel/voxel nello spazio
- Accesso ai campi DICOM opportuni (`Pixel Spacing`, `Slice Thickness`, `Image Position Patient`)

## Implementazione in MATLAB

### Funzione `interp3`

**Sintassi:**
```matlab
VI = interp3(X, Y, Z, V, XI, YI, ZI)
```

**Parametri:**
- `X, Y, Z`: vettori coordinate del volume acquisito
- `XI, YI, ZI`: vettori coordinate del volume desiderato (isotropo)
- Vettori ottenibili con `meshgrid()`

**Opzioni:** permette di scegliere il metodo di interpolazione

### Funzioni `imresize` e `imresize3`

**Quando usarle:**
- Immagini isotrope
- Fattore di interpolazione uguale per tutti gli assi

## Visualizzazione Triplanar

**Applicazione tipica:** estrazione da volumi 3D di immagini con orientamento diverso dall'acquisizione

**Principio:**
Dal volume vengono estratti **tre piani perpendicolari** tra loro attraverso interpolazione

**InterattivitÃ :**
- L'origine dei tre piani puÃ² essere definita interattivamente
- L'operatore puÃ² esplorare il volume dei dati

**DisponibilitÃ :**
- Su tutte le workstation per analisi bioimmagini

**In MATLAB:**
- Funzione: `volumeViewer`

---

> [!nav]- Navigazione
> **Precedente:** [[1. Intro|â† Introduzione Preprocessing]] | [[../INDICE|ğŸ“‘ Indice]] | **Successivo:** [[3. Filtraggio|Filtraggio â†’]]
