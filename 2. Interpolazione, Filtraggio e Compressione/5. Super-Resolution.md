---
tags:
  - super-resolution
  - PVE
  - risoluzione-fisica
  - problema-inverso
  - regolarizzazione
aliases:
  - Super-Resolution
  - Risoluzione Aumentata
---

> [!nav]- Navigazione
> **Precedente:** [[4. Compressione|â† Compressione]] | [[../INDICE|ğŸ“‘ Indice]] | **Successivo:** [[../3. Segmentaione dell'Immagine Biomedica/1. Intro|Segmentazione â†’]]

## Super-Resolution

Gli algoritmi di interpolazione descritti in precedenza possono ridurre la dimensione del voxel ma non possono ovviamente migliorare la risoluzione "fisica" dell'immagine che Ã¨ limitata dall'effetto volume parziale. Modelliamo il caso di un nodulo di piccole dimensioni nel fegato e studiamo le conseguenze del PVE sulla possibilitÃ  di riconoscere il modulo in un sistema di imaging. Consideriamo una sfera di raggio R (ad esempio 1mm), formata da un materiale che produca un segnale S1 in un certo sistema di imaging, immersa in un altro materiale con associato un segnale S2, ed eseguiamo una scansione con voxel cubico di dimensione 2Rx2Rx2R. Il valore di CNR tra sfera e tessuto contenente come visto in precedenza sarÃ :
![[Pasted image 20251129164933.png]]
Dove M1 e M2 sono i segnali misurati. Infatti M2 sarÃ  uguale a S2 mentre M1 sarÃ  dato dal contributo dei due tessuti nel voxel in dipendenza da p. La relazione ci dice che il CNR misurato si ottiene moltiplicando il valore di CNR ideale per il fattore p di riempimento del voxel. Nel caso migliore della sfera perfettamente inscritta nel cerchio p=Ï€/6 mentre nel caso peggiore di sfera inclusa in modo simmetrico in otto voxel p=Ï€/48. Quindi il CNR rispetto al valore teorico si riduce di circa il 50% nel caso migliore fino a diventare circa il 6% nel caso peggiore. Se la soglia di CNR che assicura la visibilitÃ  della sfera Ã¨ intermedia tra i due casi, non essendo prevedibile a livello di acquisizione il valore di p, la sfera risulterÃ  visibile o meno in modo casuale in dipendenza dalla posizione della sfera stessa nel sistema di imaging. Consideriamo un esempio semplificativo:
![[Pasted image 20251129164945.png]]
In figura a sinistra osserviamo una immagine ad alta risoluzione (HR) 2048x2048 di un fantoccio circolare. Il cerchio ha valore di segnale S1=1000 mentre il fondo ha valore di segnale S=100. Il raggio del cerchio r Ã¨ 128. Se interpoliamo a bassa risoluzione (LR) con passo 256 otteniamo una immagine 8x8, con dimensioni del pixel dellâ€™immagine LR uguale alle dimensioni del cerchio. Se il pixel LR corrisponde esattamente al cerchio il cerchio si riduce ad un unico pixel di valore
![[Pasted image 20251129165004.png]]![[Pasted image 20251129165013.png]]
Se il cerchio Ã¨ equi-diviso in quattro pixel LR avremo quattro pixel LR con valore diverso dal fondo pari a valore
![[Pasted image 20251129165040.png]]
Facendo variare lo â€œsfasamentoâ€ tra voxel LR e cerchio, si ottengono tutti i possibili valori di contrasto in dipendenza dallo sfasamento. Tornando al caso reale, un nodulo con dimensioni dellâ€™ordine della dimensione del voxel potrÃ  essere visibile o meno sulla base della posizione del paziente rispetto al sistema di imaging in modo del tutto imprevedibile. La â€œcertezzaâ€ di osservare lâ€™oggetto si ha solo quando le sue dimensioni sono tali da saturare con certezza almeno un intero voxel. In teoria, se ripetiamo lâ€™acquisizione un numero grande di volte variando la posizione dellâ€™oggetto e/o la posizione della griglia di acquisizione, prima o poi otterremo il caso ottimale di sfera inscritta nel voxel e quindi visibile almeno in un set di immagini. Questa idea Ã¨ alla base del concetto di super-imaging. Lâ€™idea alla base delle tecniche di Super-Resolution Ã¨ quella di combinare immagini diverse della stessa struttura anatomica per ottenere una migliore risoluzione spaziale. Consideriamo ad esempio una tipica acquisizione cardiaca MRI, nella quale vengono ottenute immagini cardiache lungo gli assi principali del cuore (asse corto, due camere, tre camere, quattro camere).
Ogni tipo di immagine Ã¨ acquisita su di un piano diverso e presenta una risoluzione spaziale fortemente anisotropica (tipicamente 1.7x.17x8 mm). Nelle tecniche di super-resolution si cerca di combinare i voxel anisotropi in modo da migliorare la risoluzione spaziale sullâ€™asse perpendicolare al piano di acquisizione (tecnicamente in MRI la slice-select direction). Nella figura sono riportati due esempi per tre acquisizioni su piani perpendicolari e per tre acquisizioni â€œinterallacciateâ€ in cui la distanza inter-slice Ã¨ una frazione del thickness.Lo stesso concetto si puÃ² applicare ad una serie temporale di immagini, con la fondamentale differenza che si ha una deformazione della struttura dellâ€™organo che va compensata con algoritmi di registrazione come sarÃ  descritto nel seguito. In generale il problema della super-resolution si puÃ² descrivere come (k=1,â€¦.N):
![[Pasted image 20251129165128.png]]
Yk sono le N immagini a bassa risoluzione che abbiamo disponibili dal sistema di imaging (le immagini reali nel modello di immagine biomedica introdotta nel primo capitolo). Dk rappresenta in processo di â€œdownsamplingâ€ che riduce il numero di pixel dellâ€™immagine X. Tk rappresenta la trasformazione geometrica che descrive la posizione della griglia di acquisizione piÃ¹ lâ€™eventuale deformazione indotta dal processo di acquisizione, ad esempio per i movimenti del paziente tra una acquisizione e lâ€™altra. hk rappresenta lâ€™effetto volume parziale che puÃ² essere modellato come la convoluzione con un kernel gaussiano in 2D o 3D. Nel caso di slice spacing nullo hk Ã¨ un filtro gaussiano 3D con kernel anisotropico con dimensione legata alla risoluzione spaziale lungo i tre assi. X Ã¨ lâ€™immagine â€œidealeâ€ ad alta risoluzione. nk Ã¨ il rumore indotto dal sistema di imaging per il quale possono essere fatte le considerazione viste in precedenza per il modello dellâ€™immagine biomedica. Lo scopo di un algoritmo di super-resolution Ã¨ stimare X note le immagini a bassa risoluzione Yk. Se la risoluzione spaziale delle immagini Yk Ã¨ la stessa, h1=h2=â€¦=hN = h e D1=D2=DN=D. Tipicamente anche il rumore avrÃ  la stessa distribuzione in tutte le acquisizioni, quindi avremo:
![[Pasted image 20251129165140.png]]
In generale il problema di stimare X da Yk Ã¨ un tipico problema inverso, che Ã¨ tipicamente â€œmal postoâ€ e quindi non ha una soluzione univoca. Il modo piÃ¹ semplice di risolvere il problema Ã¨ attraverso un algoritmo di â€œiterated back-projectionâ€, in cui viene fatta una stima di X e si cerca di minimizzare in modo iterativo la differenza tra gli Yk prodotti dalla stima di X e gli Yk misurati (M Irani et al CVGIP 1991, doi: 10.1016/1049-9652(91)90045-L). Preliminarmente alla soluzione del problema inverso, Ã¨ necessario stimare il disallineamento tra le immagini Yk . In alcuni casi il disallineamento puÃ² essere noto, ad esempio dalle informazioni DICOM. Altrimenti il disallineamento deve essere stimato attraverso un algoritmo di registrazione di immagini che verrÃ  introdotto nei capitoli successivi. Lâ€™idea di base dellâ€™algoritmo Ã¨ quella di partire da una stima dellâ€™immagine HR X0 (ottenuta ad esempio dallâ€™interpolazione di una immagine LR). A questo punto da X0 si stimano le immagini LR sulla base della conoscenza di Dk, che come prima detto si considera nota, e di h che Ã¨ un filtro opportuno che tiene conto del PVE. Si ottiene cosÃ¬ la stima di Yk al passo 1 come:
![[Pasted image 20251129165156.png]]
![[Pasted image 20251129165208.png]]
Dove C rappresenta un filtraggio di tipo passa-alto, quindi ad esempio il gradiente dellâ€™immagine, e Î³ Ã¨ una costante che rappresenta il peso della regolarizzazione nel processo di minimizzazione della metrica. Chiaramente la presenza del filtro C penalizza le soluzioni con bruschi cambiamenti di segnale ottenendo la regolarizzazione. Sono stati proposti molti altri algoritmi per la soluzione del problema inverso in super-resolution, quali il Deterministic Regularized Approach, lo Statistical Regularized Approach e altri. Per maggiori informazioni si puÃ² fare riferimento alle review di Van Reeth et al (doi: 10.1002/cmra.21249) e H Greenspan et al (doi:10.1093/comjnl/bxm075).

---

> [!nav]- Navigazione
> **Precedente:** [[4. Compressione|â† Compressione]] | [[../INDICE|ğŸ“‘ Indice]] | **Successivo:** [[../3. Segmentaione dell'Immagine Biomedica/1. Intro|Segmentazione â†’]]