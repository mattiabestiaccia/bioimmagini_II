---
tags:
  - modello-immagine
  - rumore-biologico
  - PVE
  - attenuazione
  - entropia
  - istogramma
  - volume-parziale
aliases:
  - Modello Immagine Biomedica
  - Fattori di Corruzione
---

> [!nav]- Navigazione
> **Precedente:** [[3. Computer Vision e Analisi dell'Immagine Biomedica|â† Computer Vision]] | [[INDICE|ğŸ“‘ Indice]] | **Successivo:** [[5. QualitÃ  dell'immagine Biomedica|QualitÃ  Immagine â†’]]

## Modello dell'Immagine Biomedica

> [!note] Flusso Logico
> Questo documento descrive il modello matematico dell'immagine biomedica reale.
>
> **Prerequisiti:**
> - [[2. Definizione di Immagine Biomedica|Definizione Immagine]]
>
> **Argomenti correlati:**
> - [[5. QualitÃ  dell'immagine Biomedica|QualitÃ  dell'Immagine]] (applica i concetti di rumore e PVE)
> - [[1. Dal Post-procesing all'Analisi dell'Immagine|Introduzione]]

### Immagine Ideale

L'**immagine biomedica ideale** Ã¨ definita come un insieme di regioni non sovrapposte, ognuna caratterizzata da un certo livello di grigio.

**Definizione matematica:**
$$I_0(x,y) = \sum_{k=1}^{K} S_k \cdot \Omega_k(x,y)$$

Dove:
- $S_k$: livello di grigio del tessuto $k$
- $\Omega_k$: dominio spaziale del tessuto $k$ 
- I domini $\Omega_k$ sono disgiunti
- $K$ Ã¨ "piccolo" (numero limitato di tessuti)

**Significato diagnostico:**
L'immagine ideale presenta corrispondenza univoca **tessuto â†’ valore di segnale**, permettendo di distinguere ogni tessuto senza possibilitÃ  di errore.

**Obiettivo elaborazione:**
L'elaborazione dell'immagine biomedica consiste nell'estrarre l'immagine ideale $I_0$ dall'immagine reale acquisita dal dispositivo.

## Fattori di Corruzione dell'Immagine

### 1. Rumore Biologico $n_B(x,y)$

**Definizione:** alcuni tessuti non sono omogenei ma caratterizzati da struttura interna.

**Esempi:**
- **Sangue ventricolare:** omogeneo (liquido)
- **Muscolo cardiaco:** disomogeneo (struttura a fibre)

**Dipendenza dalla risoluzione:**
Il concetto di rumore biologico dipende dalla risoluzione dell'immagine:
- Sangue: disomogeneo a livello microscopico (globuli rossi, piastrine)
- Sangue: omogeneo a livello risoluzione MRI (> 1mm)

### 2. Effetto del Volume Parziale (PVE)

**Causa:** il processo di acquisizione Ã¨ discreto â†’ il segnale viene acquisito in un volume finito di spazio.

**Conseguenza:** se due tessuti convivono nello stesso volume elementare, il voxel assume un valore **intermedio** tra i valori caratteristici dei due tessuti.

**Modellazione matematica:**
Convoluzione con kernel gaussiano $h(x,y)$ â†’ operazione di **smoothing** dei contorni

**Effetto:** agisce solo sulle **zone di transizione** tra tessuti diversi

### 3. Attenuazione

**Definizione:** distorsione continua dell'immagine lentamente variabile.

**Cause per modalitÃ :**
- **MRI:** disomogeneitÃ  campo magnetico statico o sensibilitÃ  bobine
- **Ultrasuoni:** distanza tessuto dalla sonda

**Modellazione:** campo moltiplicativo $g(x,y)$

**Caratteristica:** "smooth" (varia lentamente senza brusche transizioni)

### 4. Rumore $n(x,y)$

**Dipendenza:** la distribuzione del rumore dipende dal processo fisico di acquisizione

**Distribuzioni per modalitÃ :**
- **MRI:** distribuzione Riciana
- **US:** distribuzione di Rayleigh

**Nota importante:** il rumore non Ã¨ necessariamente di tipo **additivo**

## Modello Generale dell'Immagine Biomedica

**Formula completa:**
$$I(x,y) = [I_0(x,y) + n_B(x,y)] \otimes h(x,y) \cdot g(x,y) + n(x,y)$$

Dove:
- $I(x,y)$: immagine osservata (reale)
- $I_0(x,y)$: immagine ideale
- $n_B(x,y)$: rumore biologico
- $\otimes$: operatore di convoluzione
- $h(x,y)$: kernel PVE (tipicamente gaussiano)
- $g(x,y)$: campo di attenuazione
- $n(x,y)$: rumore di acquisizione

**Nota:** il simbolo $+$ che precede il rumore non va inteso in senso rigorosamente additivo

**Problema di stima:**
Stimare $I_0(x,y)$ conoscendo solo $I(x,y)$ â†’ problema **fortemente indeterminato**

**Approccio risolutivo:**
Modellare le varie componenti in base a dati noti e trovare una soluzione minimizzando un funzionale

## Interpretazione tramite Istogramma

### Istogramma: Definizione

**Istogramma:** rappresentazione statistica della distribuzione dei livelli di grigio nell'immagine

**Assi:**
- **X:** possibili valori di livello di grigio
- **Y:** numero di pixel con quel valore

**Istogramma normalizzato:** $\frac{h(v)}{N}$ = probabilitÃ  di trovare un pixel con valore $v$

**Binning:** spesso l'asse x Ã¨ quantizzato in regioni (bins) per migliorare la visualizzazione

### Istogramma dell'Immagine Ideale

L'istogramma di $I_0$ Ã¨ costituito da **$K$ picchi**:
- Altezza di ogni picco = numero di pixel del tessuto corrispondente
- Esempio: immagine a 6 pattern â†’ 6 picchi distinti

![[Pasted image 20251129161834.png]]

### Effetto del PVE sull'Istogramma

Applicando smoothing (simulando PVE):
1. I bordi dell'immagine si sfumano
2. Compaiono **nuovi valori di grigio** tra i picchi
3. Distribuzione uniforme dei nuovi valori

![[Pasted image 20251129161846.png]]

**Spiegazione fisica:**
Se in un voxel coesistono due tessuti con segnale $S_1$ e $S_2$:
$$S = p \cdot S_1 + (1-p) \cdot S_2$$

Dove $p \in [0,1]$ = percentuale di voxel occupato dal tessuto 1

**Distribuzione di $p$:**
In immagini biomediche reali, $p$ si puÃ² considerare distribuito **uniformemente** (griglia di acquisizione e forma oggetto non hanno relazione particolare)

**Conclusioni sul PVE:**
1. Introduce nuovi livelli di grigio compresi tra min e max dei tessuti adiacenti
2. I livelli creati sono distribuiti **uniformemente** tra i picchi
3. Il numero di livelli dipende dal **perimetro** dei pattern, non dall'area

**Dipendenza dalla risoluzione:**
L'incidenza del PVE diminuisce con pixel piÃ¹ piccoli (migliore risoluzione)

**PVE in direzione perpendicolare:**
Anche in immagini planari esiste PVE lungo l'asse z (thickness della fetta)

### Effetto dell'Attenuazione sull'Istogramma

**Conseguenza:** lo stesso tessuto assume valori diversi in parti diverse dell'immagine

**Effetto sull'istogramma:**
- Allargamento dei picchi
- Deformazione dei picchi

![[Pasted image 20251129161906.png]]

![[Pasted image 20251129161914.png]]

### Effetto del Rumore Gaussiano sull'Istogramma

**Rumore gaussiano a media nulla:** crea allargamento dei picchi

**Causa:** creazione di livelli di grigio che deviano dal valore teorico

**Dipendenza:** tanto piÃ¹ grande Ã¨ $\sigma$ (deviazione standard), tanto piÃ¹ marcato l'allargamento

![[Pasted image 20251129161934.png]]

### Istogramma dell'Immagine Reale

Applicando tutti i fattori di disturbo:

![[Pasted image 20251129161951.png]]

**Osservazione:** l'istogramma Ã¨ modificato in modo dipendente dal peso e caratteristiche dei vari fattori

### Analisi della Differenza: Immagine Reale vs Ideale

Calcolando $\Delta I = I(x,y) - I_0(x,y)$:

![[Pasted image 20251129162003.png]]

**Osservazioni:**
- Differenza piÃ¹ pronunciata nelle **zone di transizione** tra tessuti (interesse clinico)
- Differenza minore nelle **zone omogenee**
- Istogramma della differenza: maggior parte errori piccoli (vicini a zero), ma esistono variazioni molto grandi

## Entropia dell'Immagine

### Definizione di Entropia di Shannon

$$H(I) = -\sum_{g_i \in G} P(I = g_i) \cdot \log_2 P(I = g_i)$$

Dove:
- $g_i$: livelli di grigio dell'immagine $I$
- $G$: insieme dei possibili livelli di grigio
- $P(I = g_i)$: probabilitÃ  che un pixel assuma valore $g_i$

**ProprietÃ :**
- $H(I) \geq 0$ (sempre positiva)
- $H(I) = 0$ solo se $P(I = g_i) = 1$ per un singolo valore (immagine uniforme)

**Significato secondo Shannon:**
L'entropia esprime la **quantitÃ  di informazione** contenuta nell'immagine

**Casi estremi:**
- **Immagine rumore:** entropia massima
- **Immagine uniforme:** entropia minima (nulla)

### Relazione con l'Istogramma

La probabilitÃ  $P(I = g_i)$ Ã¨ l'istogramma normalizzato:

$$H(I) = -\sum_{g_i} \frac{h_I(g_i)}{N} \cdot \log_2 \frac{h_I(g_i)}{N}$$

Dove:
- $h_I$: istogramma di $I$
- $N$: numero di pixel di $I$

**Vantaggio:** l'entropia puÃ² essere calcolata facilmente dall'istogramma

### Entropia e QualitÃ  dell'Immagine

**Principio:** stabilita la configurazione dei pattern, l'immagine ideale ha **entropia minore** rispetto alle immagini con fattori di disturbo

**Esempi di entropia crescente:**

![[Pasted image 20251129162111.png]]

1. **Immagine random** (rumore casuale): entropia massima
2. **Immagine singolo pattern:** entropia nulla
3. **Immagine due pattern:** entropia bassa
4. **Due pattern + rumore gaussiano:** entropia aumentata
5. **Due pattern + PVE:** entropia aumentata

**Conclusione:** l'entropia cresce in dipendenza dai fattori che allontanano l'immagine reale dall'immagine ideale

---

> [!nav]- Navigazione
> **Precedente:** [[3. Computer Vision e Analisi dell'Immagine Biomedica|â† Computer Vision]] | [[INDICE|ğŸ“‘ Indice]] | **Successivo:** [[5. QualitÃ  dell'immagine Biomedica|QualitÃ  Immagine â†’]]
